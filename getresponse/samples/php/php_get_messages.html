
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="Generator" content="Kate, the KDE Advanced Text Editor" />
<title>php_get_messages.php</title>
</head>
<body>
<pre>
<span style="font-weight: bold;color: #000000;">&lt;?php</span>

<span style="font-style: italic;color: #808080;"># JSON-RPC module is required</span>
<span style="font-style: italic;color: #808080;"># check 'Getting started with PHP' page in API documentation</span>
<span style="color: #a1a100;">require_once</span><span style="color: #000000;"> </span><span style="color: #dd0000;">'jsonRPCClient.php'</span><span style="color: #000000;">;</span>

<span style="font-style: italic;color: #808080;"># your API key</span>
<span style="font-style: italic;color: #808080;"># check 'How to get API key' page in API documentation</span>
<span style="color: #5555ff;">$api_key</span><span style="color: #000000;"> = </span><span style="color: #dd0000;">'ENTER_YOUR_API_KEY_HERE'</span><span style="color: #000000;">;</span>

<span style="font-style: italic;color: #808080;"># API 2.x URL</span>
<span style="color: #5555ff;">$api_url</span><span style="color: #000000;"> = </span><span style="color: #dd0000;">'http://api2.getresponse.com'</span><span style="color: #000000;">;</span>

<span style="font-style: italic;color: #808080;"># initialize JSON-RPC client</span>
<span style="color: #5555ff;">$client</span><span style="color: #000000;"> = </span><span style="font-weight: bold;color: #000000;">new</span><span style="color: #000000;"> jsonRPCClient(</span><span style="color: #5555ff;">$api_url</span><span style="color: #000000;">);</span>

<span style="color: #5555ff;">$result</span><span style="color: #000000;"> = </span><span style="font-weight: bold;color: #000000;">NULL</span><span style="color: #000000;">;</span>

<span style="font-style: italic;color: #808080;"># get all messages on account</span>

<span style="font-weight: bold;color: #000000;">try</span><span style="color: #000000;"> {</span>
<span style="color: #000000;">    </span><span style="font-style: italic;color: #808080;"># call method 'get_messages' and get result</span>
<span style="color: #000000;">    </span><span style="color: #5555ff;">$result</span><span style="color: #000000;"> = </span><span style="color: #5555ff;">$client</span><span style="color: #000000;">-&gt;get_messages(</span><span style="color: #5555ff;">$api_key</span><span style="color: #000000;">);</span>
<span style="color: #000000;">}</span>
<span style="font-weight: bold;color: #000000;">catch</span><span style="color: #000000;"> (Exception </span><span style="color: #5555ff;">$e</span><span style="color: #000000;">) {</span>
<span style="color: #000000;">    </span><span style="font-style: italic;color: #808080;"># check for communication and response errors</span>
<span style="color: #000000;">    </span><span style="font-style: italic;color: #808080;"># implement handling if needed</span>
<span style="color: #000000;">    </span><span style="color: #000080;">die</span><span style="color: #000000;">(</span><span style="color: #5555ff;">$e</span><span style="color: #000000;">-&gt;getMessage());</span>
<span style="color: #000000;">}</span>

<span style="font-style: italic;color: #808080;"># display result</span>
<span style="font-style: italic;color: #808080;">#</span>
<span style="font-style: italic;color: #808080;">#     Array</span>
<span style="font-style: italic;color: #808080;">#     (</span>
<span style="font-style: italic;color: #808080;">#         [BNJ9] =&gt; Array</span>
<span style="font-style: italic;color: #808080;">#             (</span>
<span style="font-style: italic;color: #808080;">#                 [flags] =&gt; Array</span>
<span style="font-style: italic;color: #808080;">#                     (</span>
<span style="font-style: italic;color: #808080;">#                         [0] =&gt; clicktrack</span>
<span style="font-style: italic;color: #808080;">#                         [1] =&gt; openrate</span>
<span style="font-style: italic;color: #808080;">#                         [2] =&gt; google_analytics</span>
<span style="font-style: italic;color: #808080;">#                     )</span>
<span style="font-style: italic;color: #808080;">#</span>
<span style="font-style: italic;color: #808080;">#                 [campaign] =&gt; 7CT</span>
<span style="font-style: italic;color: #808080;">#                 [subject] =&gt; Sample Subject offer_1</span>
<span style="font-style: italic;color: #808080;">#                 [created_on] =&gt; 2009-01-01 00:00:00</span>
<span style="font-style: italic;color: #808080;">#                 [type] =&gt; newsletter</span>
<span style="font-style: italic;color: #808080;">#                 [send_on] =&gt; 2009-01-01 00:00:00</span>
<span style="font-style: italic;color: #808080;">#             )</span>
<span style="font-style: italic;color: #808080;">#</span>
<span style="font-style: italic;color: #808080;">#         [BNJm] =&gt; Array</span>
<span style="font-style: italic;color: #808080;">#             (</span>
<span style="font-style: italic;color: #808080;">#                 [flags] =&gt; Array</span>
<span style="font-style: italic;color: #808080;">#                     (</span>
<span style="font-style: italic;color: #808080;">#                         [0] =&gt; clicktrack</span>
<span style="font-style: italic;color: #808080;">#                         [1] =&gt; openrate</span>
<span style="font-style: italic;color: #808080;">#                         [2] =&gt; google_analytics</span>
<span style="font-style: italic;color: #808080;">#                     )</span>
<span style="font-style: italic;color: #808080;">#</span>
<span style="font-style: italic;color: #808080;">#                 [campaign] =&gt; 7CT</span>
<span style="font-style: italic;color: #808080;">#                 [subject] =&gt; Sample Subject offer_2</span>
<span style="font-style: italic;color: #808080;">#                 [created_on] =&gt; 2009-01-01 00:00:00</span>
<span style="font-style: italic;color: #808080;">#                 [type] =&gt; newsletter</span>
<span style="font-style: italic;color: #808080;">#                 [send_on] =&gt; 2009-01-01 00:00:00</span>
<span style="font-style: italic;color: #808080;">#             )</span>
<span style="font-style: italic;color: #808080;">#</span>
<span style="font-style: italic;color: #808080;">#         [TbGs] =&gt; Array</span>
<span style="font-style: italic;color: #808080;">#             (</span>
<span style="font-style: italic;color: #808080;">#                 [flags] =&gt; Array</span>
<span style="font-style: italic;color: #808080;">#                     (</span>
<span style="font-style: italic;color: #808080;">#                         [0] =&gt; clicktrack</span>
<span style="font-style: italic;color: #808080;">#                     )</span>
<span style="font-style: italic;color: #808080;"># </span>
<span style="font-style: italic;color: #808080;">#                 [campaign] =&gt; 7CT</span>
<span style="font-style: italic;color: #808080;">#                 [subject] =&gt; Sample Subject welcome</span>
<span style="font-style: italic;color: #808080;">#                 [created_on] =&gt; 2009-01-01 00:00:00</span>
<span style="font-style: italic;color: #808080;">#                 [type] =&gt; follow-up</span>
<span style="font-style: italic;color: #808080;">#                 [day_of_cycle] =&gt; 8</span>
<span style="font-style: italic;color: #808080;">#             )</span>
<span style="font-style: italic;color: #808080;">#</span>
<span style="font-style: italic;color: #808080;">#         [BO4F] =&gt; Array</span>
<span style="font-style: italic;color: #808080;">#             (</span>
<span style="font-style: italic;color: #808080;">#                 [flags] =&gt; Array</span>
<span style="font-style: italic;color: #808080;">#                     (</span>
<span style="font-style: italic;color: #808080;">#                         [0] =&gt; clicktrack</span>
<span style="font-style: italic;color: #808080;">#                         [1] =&gt; openrate</span>
<span style="font-style: italic;color: #808080;">#                         [2] =&gt; google_analytics</span>
<span style="font-style: italic;color: #808080;">#                     )</span>
<span style="font-style: italic;color: #808080;">#</span>
<span style="font-style: italic;color: #808080;">#                 [campaign] =&gt; 91k</span>
<span style="font-style: italic;color: #808080;">#                 [subject] =&gt; Sample Subject offer_1</span>
<span style="font-style: italic;color: #808080;">#                 [created_on] =&gt; 2009-01-01 00:00:00</span>
<span style="font-style: italic;color: #808080;">#                 [type] =&gt; newsletter</span>
<span style="font-style: italic;color: #808080;">#                 [send_on] =&gt; 2009-01-01 00:00:00</span>
<span style="font-style: italic;color: #808080;">#             )</span>
<span style="font-style: italic;color: #808080;">#</span>
<span style="font-style: italic;color: #808080;">#     )</span>
<span style="font-style: italic;color: #808080;">#</span>
<span style="color: #000080;">print_r</span><span style="color: #000000;">(</span><span style="color: #5555ff;">$result</span><span style="color: #000000;">);</span>

<span style="font-style: italic;color: #808080;"># get messages with campaigns, type and subject conditions</span>

<span style="font-weight: bold;color: #000000;">try</span><span style="color: #000000;"> {</span>
<span style="color: #000000;">    </span><span style="font-style: italic;color: #808080;"># call method 'get_messages' and get result</span>
<span style="color: #000000;">    </span><span style="color: #5555ff;">$conditions</span><span style="color: #000000;"> = </span><span style="color: #000080;">Array</span><span style="color: #000000;">(</span>
<span style="color: #000000;">        </span><span style="color: #dd0000;">'campaigns'</span><span style="color: #000000;"> =&gt; </span><span style="color: #000080;">Array</span><span style="color: #000000;">( </span><span style="color: #dd0000;">'7CT'</span><span style="color: #000000;"> ),</span>
<span style="color: #000000;">        </span><span style="color: #dd0000;">'type'</span><span style="color: #000000;"> =&gt; </span><span style="color: #dd0000;">'newsletter'</span><span style="color: #000000;">,</span>
<span style="color: #000000;">        </span><span style="color: #dd0000;">'subject'</span><span style="color: #000000;"> =&gt; </span><span style="color: #000080;">Array</span><span style="color: #000000;">( </span><span style="color: #dd0000;">'MATCHES'</span><span style="color: #000000;"> =&gt; </span><span style="color: #dd0000;">'offer_1'</span><span style="color: #000000;"> )</span>
<span style="color: #000000;">    );</span>
<span style="color: #000000;">    </span><span style="color: #5555ff;">$result</span><span style="color: #000000;"> = </span><span style="color: #5555ff;">$client</span><span style="color: #000000;">-&gt;get_messages(</span><span style="color: #5555ff;">$api_key</span><span style="color: #000000;">, </span><span style="color: #5555ff;">$conditions</span><span style="color: #000000;">);</span>
<span style="color: #000000;">}</span>
<span style="font-weight: bold;color: #000000;">catch</span><span style="color: #000000;"> (Exception </span><span style="color: #5555ff;">$e</span><span style="color: #000000;">) {</span>
<span style="color: #000000;">    </span><span style="font-style: italic;color: #808080;"># check for communication and response errors</span>
<span style="color: #000000;">    </span><span style="font-style: italic;color: #808080;"># implement handling if needed</span>
<span style="color: #000000;">    </span><span style="color: #000080;">die</span><span style="color: #000000;">(</span><span style="color: #5555ff;">$e</span><span style="color: #000000;">-&gt;getMessage());</span>
<span style="color: #000000;">}</span>

<span style="font-style: italic;color: #808080;"># display result</span>
<span style="font-style: italic;color: #808080;">#</span>
<span style="font-style: italic;color: #808080;"># Array</span>
<span style="font-style: italic;color: #808080;"># (</span>
<span style="font-style: italic;color: #808080;">#         [BNJ9] =&gt; Array</span>
<span style="font-style: italic;color: #808080;">#             (</span>
<span style="font-style: italic;color: #808080;">#                 [flags] =&gt; Array</span>
<span style="font-style: italic;color: #808080;">#                     (</span>
<span style="font-style: italic;color: #808080;">#                         [0] =&gt; clicktrack</span>
<span style="font-style: italic;color: #808080;">#                         [1] =&gt; openrate</span>
<span style="font-style: italic;color: #808080;">#                         [2] =&gt; google_analytics</span>
<span style="font-style: italic;color: #808080;">#                     )</span>
<span style="font-style: italic;color: #808080;">#</span>
<span style="font-style: italic;color: #808080;">#                 [campaign] =&gt; 7CT</span>
<span style="font-style: italic;color: #808080;">#                 [subject] =&gt; Sample Subject offer_1</span>
<span style="font-style: italic;color: #808080;">#                 [created_on] =&gt; 2009-01-01 00:00:00</span>
<span style="font-style: italic;color: #808080;">#                 [type] =&gt; newsletter</span>
<span style="font-style: italic;color: #808080;">#                 [send_on] =&gt; 2009-01-01 00:00:00</span>
<span style="font-style: italic;color: #808080;">#             )</span>
<span style="font-style: italic;color: #808080;">#</span>
<span style="font-style: italic;color: #808080;"># )</span>
<span style="font-style: italic;color: #808080;">#</span>
<span style="color: #000080;">print_r</span><span style="color: #000000;">(</span><span style="color: #5555ff;">$result</span><span style="color: #000000;">);</span>

<span style="font-weight: bold;color: #000000;">?&gt;</span></pre></body>
</html>
